
#################################################
# Global test configuration
#################################################
config:

  # Introduce some indicators that will be fed to datadog
  indicators:

    # Calculate `meanDeploymentTime` by calculating the normalizing average
    # of all the `deploymentTime` mean values, normalized against the number
    # of instances
    - name: meanDeploymentTime
      class: indicator.NormalizedMeanMetricIndicator
      metric: deploymentTime.mean
      parameter: apps

    # Calculate `meanHttpRequestTime` by calculating the normalizing average
    # of all the `deploymentTime` mean values, normalized against the number
    # of instances
    - name: meanHttpRequestTime
      class: indicator.NormalizedMeanMetricIndicator
      metric: httpRequestTime.mean
      parameter: apps

  # We require datadog credentials to be given through the command-line
  definitions:
    - name: datadog_api_key
      desc: The datadog API Key
      required: yes
    - name: datadog_app_key
      desc: The datadog App Key
      required: yes

#################################################
# Global test configuration
#################################################
reporters:

  - class: reporter.DataDogReporter
    api_key: "{{datadog_api_key}}"
    app_key: "{{datadog_app_key}}"
    prefix: "marathon.perf."
    points:
      - name: meanDeploymentTime
        indicator: meanDeploymentTime
      - name: meanHttpRequestTime
        indicator: meanHttpRequestTime
